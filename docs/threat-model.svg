<?xml version="1.0" encoding="UTF-8"?>
<svg width="1100" height="560" viewBox="0 0 1100 560" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Before and after threat model: many secrets given to agents vs one Turret token gating capabilities">
  <defs>
    <style>
      .title { font: 700 20px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #111; }
      .label { font: 14px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #111; }
      .small { font: 12px ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; fill: #333; }
      .box { fill: #fff; stroke: #222; stroke-width: 1.5; }
      .subbox { fill: #f8fafc; stroke: #222; stroke-width: 1.2; }
      .cloud { fill: #fff7ed; stroke: #222; stroke-width: 1.2; }
      .turret { fill: #ecfeff; stroke: #0f172a; stroke-width: 2; }
      .danger { fill: #fff1f2; stroke: #9f1239; stroke-width: 1.6; }
      .arrow { stroke: #111; stroke-width: 1.6; fill: none; marker-end: url(#m); }
      .dashed { stroke-dasharray: 6 5; }
    </style>
    <marker id="m" viewBox="0 0 10 10" refX="9" refY="5" markerWidth="7" markerHeight="7" orient="auto-start-reverse">
      <path d="M 0 0 L 10 5 L 0 10 z" fill="#111" />
    </marker>
  </defs>

  <!-- Headings -->
  <text x="60" y="40" class="title">Before: many-to-many secrets</text>
  <text x="640" y="40" class="title">After: one token, capability gateway</text>

  <!-- Left: BEFORE -->
  <rect x="40" y="60" width="500" height="470" class="box" rx="12" />
  <text x="60" y="90" class="label">Your host / homelab</text>

  <rect x="80" y="140" width="180" height="90" class="danger" rx="12" />
  <text x="100" y="175" class="label">AI Agent</text>
  <text x="100" y="198" class="small">(cloud-backed)</text>

  <rect x="80" y="250" width="180" height="110" class="danger" rx="12" />
  <text x="100" y="282" class="label">Secrets in env</text>
  <text x="100" y="305" class="small">tokens, passwords, keys</text>
  <text x="100" y="328" class="small">often visible to tools</text>

  <rect x="320" y="120" width="180" height="60" class="subbox" rx="10" />
  <text x="340" y="155" class="label">Service A</text>
  <rect x="320" y="200" width="180" height="60" class="subbox" rx="10" />
  <text x="340" y="235" class="label">Service B</text>
  <rect x="320" y="280" width="180" height="60" class="subbox" rx="10" />
  <text x="340" y="315" class="label">Service C</text>
  <rect x="320" y="360" width="180" height="60" class="subbox" rx="10" />
  <text x="340" y="395" class="label">Service D</text>

  <path d="M 260 175 C 290 165, 300 155, 320 150" class="arrow" />
  <path d="M 260 175 C 290 195, 300 215, 320 230" class="arrow" />
  <path d="M 260 175 C 285 240, 300 290, 320 310" class="arrow" />
  <path d="M 260 175 C 285 295, 300 375, 320 390" class="arrow" />

  <path d="M 170 250 L 170 230" class="arrow" />

  <rect x="90" y="405" width="420" height="90" class="danger" rx="12" />
  <text x="110" y="440" class="label">Problem</text>
  <text x="110" y="463" class="small">Agent sees many secrets; recovery means rotating everything.</text>

  <!-- Cloud provider (external trust boundary) -->
  <rect x="150" y="100" width="240" height="35" class="cloud" rx="18" />
  <text x="170" y="123" class="small">Model provider logs / retention</text>
  <path d="M 170 140 C 170 120, 210 118, 240 118" class="arrow dashed" />

  <!-- Right: AFTER -->
  <rect x="600" y="60" width="460" height="470" class="box" rx="12" />
  <text x="620" y="90" class="label">Your host / homelab</text>

  <rect x="640" y="140" width="170" height="90" class="danger" rx="12" />
  <text x="660" y="175" class="label">AI Agent</text>
  <text x="660" y="198" class="small">(cloud-backed)</text>

  <rect x="640" y="245" width="170" height="55" class="subbox" rx="10" />
  <text x="660" y="278" class="small">1 token to Turret</text>

  <rect x="835" y="140" width="200" height="90" class="turret" rx="12" />
  <text x="855" y="175" class="label">Turret</text>
  <text x="855" y="198" class="small">policy + audit + proxy</text>

  <path d="M 810 175 L 835 175" class="arrow" />

  <rect x="835" y="250" width="200" height="75" class="subbox" rx="10" />
  <text x="855" y="278" class="label">Actions</text>
  <text x="855" y="301" class="small">exec templates</text>

  <rect x="620" y="350" width="190" height="60" class="subbox" rx="10" />
  <text x="640" y="385" class="label">Service A</text>
  <rect x="620" y="420" width="190" height="60" class="subbox" rx="10" />
  <text x="640" y="455" class="label">Service B</text>
  <rect x="830" y="350" width="205" height="60" class="subbox" rx="10" />
  <text x="850" y="385" class="label">Service C</text>
  <rect x="830" y="420" width="205" height="60" class="subbox" rx="10" />
  <text x="850" y="455" class="label">Service D</text>

  <path d="M 935 230 L 935 250" class="arrow" />
  <path d="M 935 325 C 850 340, 770 355, 810 375" class="arrow" />
  <path d="M 935 325 C 850 385, 770 420, 810 450" class="arrow" />
  <path d="M 935 325 C 980 340, 995 350, 1035 375" class="arrow" />
  <path d="M 935 325 C 980 385, 995 420, 1035 450" class="arrow" />

  <rect x="625" y="500" width="410" height="30" class="turret" rx="12" />
  <text x="640" y="520" class="small">Gap filled: secrets stay local; agent gets one revocable credential.</text>
</svg>
